import { useState, useEffect } from 'react';
import { useRouter } from 'next/navigation';
import supabase from '@/lib/supabase';

// ... existing code ...
// Remove unused RainbowButton import
// import { RainbowButton } from "@/components/ui/rainbow-button"; // Unused import

// Update useEffect to include router in the dependency array
useEffect(() => {
  const getUser = async () => {
    const { data: { user } } = await supabase.auth.getUser()
    if (!user) {
      router.push('/landing');
      return
    }
    setUser(user)
  }
  getUser()
}, [supabase, router]) // Added router to dependencies

// Specify a more specific type instead of any
const [books, setBooks] = useState<{ name: string }[]>([]); // Updated type for books

// Remove unused variable data
// const { data, error } = await supabase // Unused variable

// Specify a more specific type instead of any
const { data: { embedding } } = await supabase.functions.invoke('embed', {
  body: { input: fullText }
}) as { data: { embedding: unknown } }; // Updated type for embedding

// Specify a more specific type instead of any
const { data, error } = await supabase
  .from('books')
  .insert([{
    user_id: user.id,
    path: file.name,
    text: fullText,
    embedding: embedding
  }]) as { data: unknown, error: unknown }; // Updated type for data and error

// ... existing code ... 